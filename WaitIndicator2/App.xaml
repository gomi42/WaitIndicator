<Application x:Class="WaitIndicator2.App"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:s="clr-namespace:WaitIndicator2"
             StartupUri="MainWindow.xaml">
    <Application.Resources>
        <Color x:Key="FilledColor">#FF9B9B9B</Color>
        <SolidColorBrush x:Key="FilledBrush"
                         Color="{StaticResource FilledColor}" />

        <Style x:Key="StyleWithMultipleStoryboards"
               TargetType="s:WaitIndicator">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="s:WaitIndicator">
                        <ControlTemplate.Resources>
                            <Storyboard x:Key="Animation0"
                                        BeginTime="00:00:00.0"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse0"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>

                            <Storyboard x:Key="Animation1"
                                        BeginTime="00:00:00.2"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse1"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>

                            <Storyboard x:Key="Animation2"
                                        BeginTime="00:00:00.4"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse2"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>

                            <Storyboard x:Key="Animation3"
                                        BeginTime="00:00:00.6"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse3"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>

                            <Storyboard x:Key="Animation4"
                                        BeginTime="00:00:00.8"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse4"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>

                            <Storyboard x:Key="Animation5"
                                        BeginTime="00:00:01.0"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse5"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>

                            <Storyboard x:Key="Animation6"
                                        BeginTime="00:00:01.2"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse6"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>

                            <Storyboard x:Key="Animation7"
                                        BeginTime="00:00:01.4"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse7"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                            </Storyboard>
                        </ControlTemplate.Resources>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsVisible" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard x:Name="Storyboard0"
                                                     Storyboard="{StaticResource Animation0}" />
                                    <BeginStoryboard x:Name="Storyboard1"
                                                     Storyboard="{StaticResource Animation1}" />
                                    <BeginStoryboard x:Name="Storyboard2"
                                                     Storyboard="{StaticResource Animation2}" />
                                    <BeginStoryboard x:Name="Storyboard3"
                                                     Storyboard="{StaticResource Animation3}" />
                                    <BeginStoryboard x:Name="Storyboard4"
                                                     Storyboard="{StaticResource Animation4}" />
                                    <BeginStoryboard x:Name="Storyboard5"
                                                     Storyboard="{StaticResource Animation5}" />
                                    <BeginStoryboard x:Name="Storyboard6"
                                                     Storyboard="{StaticResource Animation6}" />
                                    <BeginStoryboard x:Name="Storyboard7"
                                                     Storyboard="{StaticResource Animation7}" />
                                </Trigger.EnterActions>

                                <Trigger.ExitActions>
                                    <StopStoryboard BeginStoryboardName="Storyboard0" />
                                    <StopStoryboard BeginStoryboardName="Storyboard1" />
                                    <StopStoryboard BeginStoryboardName="Storyboard2" />
                                    <StopStoryboard BeginStoryboardName="Storyboard3" />
                                    <StopStoryboard BeginStoryboardName="Storyboard4" />
                                    <StopStoryboard BeginStoryboardName="Storyboard5" />
                                    <StopStoryboard BeginStoryboardName="Storyboard6" />
                                    <StopStoryboard BeginStoryboardName="Storyboard7" />
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>

                        <Canvas>
                            <Canvas.Resources>
                                <Style TargetType="Ellipse">
                                    <Setter Property="Fill" Value="{StaticResource FilledBrush}" />
                                </Style>
                            </Canvas.Resources>

                            <Ellipse x:Name="Part_Ellipse0" />
                            <Ellipse x:Name="Part_Ellipse1" />
                            <Ellipse x:Name="Part_Ellipse2" />
                            <Ellipse x:Name="Part_Ellipse3" />
                            <Ellipse x:Name="Part_Ellipse4" />
                            <Ellipse x:Name="Part_Ellipse5" />
                            <Ellipse x:Name="Part_Ellipse6" />
                            <Ellipse x:Name="Part_Ellipse7" />
                        </Canvas>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>


        <!--  style with a single storyboard  -->

        <Style TargetType="s:WaitIndicator">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="s:WaitIndicator">
                        <ControlTemplate.Resources>
                            <Storyboard x:Key="Animation"
                                        BeginTime="00:00:00.0"
                                        RepeatBehavior="Forever">
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse1"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="0.175"
                                                 To="0"
                                                 Duration="0:0:0.2" />
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse2"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="0.25"
                                                 To="0"
                                                 Duration="0:0:0.4" />
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse3"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="0.375"
                                                 To="0"
                                                 Duration="0:0:0.6" />
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse4"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="0.5"
                                                 To="0"
                                                 Duration="0:0:0.8" />
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse5"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="0.625"
                                                 To="0"
                                                 Duration="0:0:1.0" />
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse6"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="0.75"
                                                 To="0"
                                                 Duration="0:0:1.2" />
                                <DoubleAnimation Storyboard.TargetName="Part_Ellipse7"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="0.875"
                                                 To="0"
                                                 Duration="0:0:1.4" />

                                <DoubleAnimation BeginTime="0:0:0.0"
                                                 Storyboard.TargetName="Part_Ellipse0"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0"
                                                 Duration="0:0:1.6" />
                                <DoubleAnimation BeginTime="0:0:0.2"
                                                 Storyboard.TargetName="Part_Ellipse1"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0.125"
                                                 Duration="0:0:1.4" />
                                <DoubleAnimation BeginTime="0:0:0.4"
                                                 Storyboard.TargetName="Part_Ellipse2"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0.25"
                                                 Duration="0:0:1.2" />
                                <DoubleAnimation BeginTime="0:0:0.6"
                                                 Storyboard.TargetName="Part_Ellipse3"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0.375"
                                                 Duration="0:0:1.0" />
                                <DoubleAnimation BeginTime="0:0:0.8"
                                                 Storyboard.TargetName="Part_Ellipse4"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0.5"
                                                 Duration="0:0:0.8" />
                                <DoubleAnimation BeginTime="0:0:1.0"
                                                 Storyboard.TargetName="Part_Ellipse5"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0.625"
                                                 Duration="0:0:0.6" />
                                <DoubleAnimation BeginTime="0:0:1.2"
                                                 Storyboard.TargetName="Part_Ellipse6"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0.75"
                                                 Duration="0:0:0.4" />
                                <DoubleAnimation BeginTime="0:0:1.4"
                                                 Storyboard.TargetName="Part_Ellipse7"
                                                 Storyboard.TargetProperty="Opacity"
                                                 From="1"
                                                 To="0.875"
                                                 Duration="0:0:0.2" />
                            </Storyboard>
                        </ControlTemplate.Resources>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsVisible" Value="True">
                                <Trigger.EnterActions>
                                    <BeginStoryboard x:Name="Storyboard"
                                                     Storyboard="{StaticResource Animation}" />
                                </Trigger.EnterActions>

                                <Trigger.ExitActions>
                                    <StopStoryboard BeginStoryboardName="Storyboard" />
                                </Trigger.ExitActions>
                            </Trigger>
                        </ControlTemplate.Triggers>

                        <Canvas>
                            <Canvas.Resources>
                                <Style TargetType="Ellipse">
                                    <Setter Property="Fill" Value="{StaticResource FilledBrush}" />
                                </Style>
                            </Canvas.Resources>

                            <Ellipse x:Name="Part_Ellipse0" />
                            <Ellipse x:Name="Part_Ellipse1" />
                            <Ellipse x:Name="Part_Ellipse2" />
                            <Ellipse x:Name="Part_Ellipse3" />
                            <Ellipse x:Name="Part_Ellipse4" />
                            <Ellipse x:Name="Part_Ellipse5" />
                            <Ellipse x:Name="Part_Ellipse6" />
                            <Ellipse x:Name="Part_Ellipse7" />
                        </Canvas>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Application.Resources>
</Application>
